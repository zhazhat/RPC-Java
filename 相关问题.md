项目描述：

基于java语言实现分布式场景下本地服务在RPC节点上的注册、发布与远程调用功能，并针对各种场景进行了思考和优化。

主要工作：

1. 实现自定义通信协议，解决沾包问题；自定义编/解码器和序列化器，实现java原生和fastjson，protobuf数据序列化方式；

2. 使用高性能网络框架Netty实现NIO网络通信，消费端采用 Netty 方式，会复用 Channel 避免多次连接，提高性能；

3. 使用分布式协调应用Zookeeper作为注册中心和配置中心；在客户端建立缓存，避免频繁访问注册中心；使用Watcher监 听zookeeper节点变化，根据event事件类型动态更新本地缓存；

4. 为客户端提供4种负载均衡策略选择：服务轮询、随机访问、LRU最近最少使用和一致性哈希算法；
5. 使用Guava-Retry框架实现对白名单上幂等性服务进行超时重试机制，指定重试策略；

6. 在服务端实现服务降级：故障降级，故障一定次数会通知注册中心下线节点；

7. 限流降级，使用令牌桶算法实现接口限流

8. 客户端设置熔断器，监测服务调用情况进行3种状态的切换，从而实现熔断保护；对已下线的节点进行定时探测，保证容错性
#### RPC前置知识
RPC 使用场景 （大型的网站，内部子系统较多、接口非常多的情况下适合使用 RPC）：
- 长链接。不必每次通信都要像 HTTP 一样去 3 次握手，减少了网络开销。
- 注册发布机制。RPC 框架一般都有注册中心，有丰富的监控管理；发布、下线接口、动态扩展等，对调用方来说是无感知、统一化的操作。
- 安全性，没有暴露资源操作。
- 微服务支持。就是最近流行的服务化架构、服务化治理，RPC 框架是一个强力的支撑。
  个人收获：
#### 个人收获
- 学习了分布式网络通信RPC架构的设计原理，注册中心，本地缓存，负载均衡，服务降级，降级熔断等设计思想
- 了解了netty框架的相关基本操作，对其在网络通信方面的优势有了一定理解
- 了解了zookeeper的使用，以及其在项目中的应用场景；利用zookeeper的事件监听和配置中心机制对框架进行一定优化
#### 为什么使用zookeeper
Dubbo官方推荐使用Zookeeper作为服务注册中心。

Zookeeper 是 Apache Hadoop 的子项目，是一个树型的目录服务，支持变更推送，适合作为 Dubbo 服务的注册中心，工业强度较高，可用于生产环境，并推荐使用 。

#### TCP粘包拆包问题

TCP在接受数据的时候，有一个滑动窗口来控制接受数据的大小，这个滑动窗口你就可以理解为一个缓冲区的大小。缓冲区满了就会把数据发送。数据包的大小是不固定的，有时候比缓冲区大有时候小。 如果一次请求发送的数据量比较小，没达到缓冲区大小，TCP则会将多个请求合并为同一个请求进行发送，这就形成了粘包问题； 如果一次请求发送的数据量比较大，超过了缓冲区大小，TCP就会将其拆分为多次发送，这就是拆包，也就是将一个大的包拆分为多个小包进行发送。

UDP不会发生粘包问题：UDP具有保护消息边界,在每个UDP包中就有了消息头(UDP长度、源端口、目的端口、校验和)

[聊聊TCP协议的粘包、拆包以及http是如何解决的？_tcp拆包粘包-CSDN博客](https://blog.csdn.net/cj_eryue/article/details/131046881)

#### 常见序列化方式

[Java序列化方式-CSDN博客](https://blog.csdn.net/qq_33314107/article/details/80836185)

[Java序列化，看这篇就够了-腾讯云开发者社区-腾讯云](https://cloud.tencent.com/developer/article/1783576)

### **5.netty的常见八股**

BIO,NIO；netty的构成，组件，执行流程

[【硬核】肝了一月的Netty知识点-CSDN博客](https://blog.csdn.net/qq_35190492/article/details/113174359?spm=1001.2014.3001.5506)

[45 张图深度解析 Netty 架构与原理-腾讯云开发者社区-腾讯云](https://cloud.tencent.com/developer/article/1754078)


#### 一致性哈希

[何为一致性哈希？一致性哈希和哈希有什么区别？一文深入理解一致性哈希-CSDN博客](https://blog.csdn.net/weixin_45683778/article/details/136694740)

项目常见问题
网络传输层面


1.netty传输位于网络结构模型中的哪一层？

2.netty的常见八股

3.讲一讲netty在你项目中的作用和执行流程？



4.为什么会出现沾包问题？如何解决的？

5.你觉得哪种数据序列化方式最好？





注册中心层面


1.zookeeper在项目中的角色？你为什么使用zookeeper

2.注册中心的意义？

3.zookeeper的常见八股





算法层面


1.四种负载均衡算法的比较？

2.讲一讲一致性哈希算法？

3.限流算法有哪些？

4.令牌桶算法如何实现的？





各种场景题


这方面一般是围绕着降级熔断重试 等等问题来回答，主要考察项目是否是自己做出来的，是否有对项目有过思考

问题五花八门

举几个例子，比如：

1.本地缓存怎么做的？能保证缓存和服务的一致性吗？



2.某个服务多个节点承压能力不一，怎么办？



3.每个服务都进行重试吗？



4.网络抖动导致某个节点被下线了，过一会网络好了，考虑过这个问题吗？